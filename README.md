# GLcdLib
ESP32用 グラフィックLCDライブラリ。SPI-DMAで動作します。

## 概要
- ESP32でグラフィックLCDを使用する際のテキスト／画像／図形描画ライブラリです。
- 自分がパッと使えるように置いています。
- 予告なしに改造します。改造前との互換性は考慮しません。

## 動作確認環境
- Windows11
- PlatformIO + ArduinoFramework
- ESP32, ESP32-C3
- SPI-LCD: ST7735(160x128), ST7789(320x240), ILI9225(176x220)

## クラス図（概要）
```
main +-----◆ {Graphic LCD class} -----△ GLcd +-----△ GLcdText +- - -△ IGLcd <<interface>>
     |-----◆ Color                            |                 |-----◆ Font
     +-----◆ Image                            |                 +- - -＞ Color <<use>>
                                               |
                                               |-----△ GLcdImage +- - -△ IGLcd <<interface>>
                                               |                  |-----◆ ByteReader
                                               |                  |- - -＞ Image <<use>>
                                               |                  +- - -＞ Rectangle <<use>>
                                               |
                                               |-----△ GLcdGraphics +- - -△ IGLcd <<interface>>
                                               |                     +- - -＞ Color <<use>>
                                               |
                                               +-----◆ GLcdSpiDma - - -＞ SpiDma <<use>>
{Graphic LCD class} = LcdST77xx,LcdILI9225
```
#### 凡例
```
A-----◆B クラスAはメンバーとしてクラスBの実体を持つ
A-----◇B クラスAはメンバーとしてクラスBのポインタを持つ　※図中にはない
A-----△B クラスAはクラスBを継承する
          ・Aが派生クラス、Bが基底クラス
A- - -△B クラスAはインターフェースBを継承する
          ・Bは純粋仮想関数のみを持つクラス
A- - -＞B クラスAはクラスBを使用するが、メンバーとして持ってはいない
          ・Aは関数の引数やローカル変数としてBを使用する
```
## クラスの説明
### LcdST77xx, LcdILI9225
- グラフィックLCDデバイス個別クラス
- GLcdクラスを継承し、コントローラー固有であるレジスタ操作を実装する

### GLcd
- グラフィックLCDデバイスを抽象化したクラス
- デバイスの機能設定を担う
- 描画機能は持たない

### GLcdText
- テキスト描画機能をまとめたクラス
- 文字列、数値（10進数,16進数）
- 縦横独立して文字サイズ（倍率）を設定可

### GLcdImage
- 画像描画機能をまとめたクラス
- RGB565等のbyte配列を扱う（BMP等を直接扱うものではない）
- クリッピングに対応

### GLcdGraphics
- 図形描画機能をまとめたクラス
- 点、直線（水平・垂直・斜め）、四角形、三角形、円
- 線で描画、塗りつぶし

### IGLcd
- GLcdクラスのうちGRAMデータ送信機能を定義したインターフェース
- GLcdクラスを拡張するGLcdXxxxクラスで描画機能を定義することができる

### GLcdSpiDma
- SpiDmaクラスのラッパー
- D/Cピンの制御を含めるなどグラフィックLCDデバイス向けにしたもの

### SpiDma
- DMAで動作するSPIクラス
- データ送信バッファを24KB(ESP32-C3)、または32KB(ESP32)持つ

### Color
- 色クラス
- RGB各8bitを与えてRGB565等の色データを作成する

### Image
- 画像クラス
- 色データや幅・高さなど画像情報をまとめて扱うことができる

### Font
- GLcdTextクラスで使用するフォントクラス
- HD44780と同等の5x7ドットのフォント
- フォントデータはSSD1306などページ型グラフィックLCD向けの形式で定義されている

### Rectangle
- GLcdImageクラスで使用する矩形領域クラス
- 主にクリッピング処理を担う

### ByteReader
- GLcdImageクラスで使用するbyte配列読み込みクラス
- 数100KBの大きなデータを数KBの小さなバッファサイズで順次読み込むことができる
- 画像データ（一次元配列）の矩形領域にあたる箇所を取り出して読み込むことができる
